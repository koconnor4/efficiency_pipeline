

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API Documentation &mdash; efficiency_pipeline 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery-dataframe.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Primary Contributors" href="contributors.html" />
    <link rel="prev" title="Basic Functionality" href="examples/plot_package.html" />
    <link href="_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> efficiency_pipeline
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/plot_package.html">Basic Functionality</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributors.html">Primary Contributors</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">efficiency_pipeline</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>API Documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api-documentation">
<h1>API Documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h1>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="efficiency-pipeline">
<h2>efficiency_pipeline<a class="headerlink" href="#efficiency-pipeline" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-efficiency_pipeline.lco_fakeSNpipeline">
<span id="lco-fakesnpipeline"></span><h3>lco_fakeSNpipeline<a class="headerlink" href="#module-efficiency_pipeline.lco_fakeSNpipeline" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="efficiency_pipeline.lco_fakeSNpipeline.detection_efficiency">
<code class="sig-prename descclassname">efficiency_pipeline.lco_fakeSNpipeline.</code><code class="sig-name descname">detection_efficiency</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">plant</span></em>, <em class="sig-param"><span class="n">cat</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/efficiency_pipeline/lco_fakeSNpipeline.html#detection_efficiency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#efficiency_pipeline.lco_fakeSNpipeline.detection_efficiency" title="Permalink to this definition">¶</a></dt>
<dd><p>The detection efficiency NSN detected to NSN planted measurement
determines true and false detections as SN plant within 5 pixel radius of detected location
breaks up true into repeat and single detections i.e. which plants were detected multiple times at slightly different loc
plant argument from plant helper function has the image w plants and where they are located
cat argument from source_cat function applied to image w plants i.e. you need to do the detection on plant im</p>
</dd></dl>

<dl class="py function">
<dt id="efficiency_pipeline.lco_fakeSNpipeline.ePSF">
<code class="sig-prename descclassname">efficiency_pipeline.lco_fakeSNpipeline.</code><code class="sig-name descname">ePSF</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stars</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'psf.fits'</span></em>, <em class="sig-param"><span class="n">oversampling</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/efficiency_pipeline/lco_fakeSNpipeline.html#ePSF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#efficiency_pipeline.lco_fakeSNpipeline.ePSF" title="Permalink to this definition">¶</a></dt>
<dd><p>function that builds an effective point spread function using an image’s stars using photutils
the effective point spread function representing truth more carefully than a 2d gaussian
minimal oversampling 2 is default since LCO is already oversampling the PSFs:
typical rp_fwhm ~ 2 arcsec and pixscale ~ 0.4 arcsec
stars argument is stars helper fcn</p>
</dd></dl>

<dl class="py function">
<dt id="efficiency_pipeline.lco_fakeSNpipeline.gaia_results">
<code class="sig-prename descclassname">efficiency_pipeline.lco_fakeSNpipeline.</code><code class="sig-name descname">gaia_results</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/efficiency_pipeline/lco_fakeSNpipeline.html#gaia_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#efficiency_pipeline.lco_fakeSNpipeline.gaia_results" title="Permalink to this definition">¶</a></dt>
<dd><p>epsf helper function uses Gaia query to get stars in image
image argument is the LCO fits file</p>
</dd></dl>

<dl class="py function">
<dt id="efficiency_pipeline.lco_fakeSNpipeline.gaussian2d">
<code class="sig-prename descclassname">efficiency_pipeline.lco_fakeSNpipeline.</code><code class="sig-name descname">gaussian2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">epsf</span></em>, <em class="sig-param"><span class="n">hdr</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/efficiency_pipeline/lco_fakeSNpipeline.html#gaussian2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#efficiency_pipeline.lco_fakeSNpipeline.gaussian2d" title="Permalink to this definition">¶</a></dt>
<dd><p>function to fit 2d gaussian to epsf
photutils fit 2d gaussian has 7 parameters (constant,amplitude,x_mean,y_mean,x_stddev,y_stddev,theta)
epsf argument is the photutils epsf from epsf fcn
hdr optional argument will compare the L1fwhm available in reduced image to the fit</p>
</dd></dl>

<dl class="py function">
<dt id="efficiency_pipeline.lco_fakeSNpipeline.get_data">
<code class="sig-prename descclassname">efficiency_pipeline.lco_fakeSNpipeline.</code><code class="sig-name descname">get_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/efficiency_pipeline/lco_fakeSNpipeline.html#get_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#efficiency_pipeline.lco_fakeSNpipeline.get_data" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function that gets you a dictionary that uses filenames as keys to fits
assumes images tucked in dirs like dia_out, dia_trim, source_im
path argument should be string to where you are working
if images not tucked in the dirs … can uncomment these
ims=glob.glob(‘<a href="#id1"><span class="problematic" id="id2">*</span></a>fits’)
for i in range(len(ims)):</p>
<blockquote>
<div><p>filename = ims[i].split(‘/’)[-1]
my_data[filename] = fits.open(ims[i])[0]</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="efficiency_pipeline.lco_fakeSNpipeline.lattice">
<code class="sig-prename descclassname">efficiency_pipeline.lco_fakeSNpipeline.</code><code class="sig-name descname">lattice</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/efficiency_pipeline/lco_fakeSNpipeline.html#lattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#efficiency_pipeline.lco_fakeSNpipeline.lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>grid detection efficiency helper function gives evenly spaced skycoord and pixel locations
spacing is 100 pixels, limited to 100 pixels away from edge
image argument is the fits file</p>
</dd></dl>

<dl class="py function">
<dt id="efficiency_pipeline.lco_fakeSNpipeline.lco_pipe">
<code class="sig-prename descclassname">efficiency_pipeline.lco_fakeSNpipeline.</code><code class="sig-name descname">lco_pipe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lco_path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">date_key</span><span class="o">=</span><span class="default_value">'sbatch'</span></em>, <em class="sig-param"><span class="n">field_key</span><span class="o">=</span><span class="default_value">'sbatch'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/efficiency_pipeline/lco_fakeSNpipeline.html#lco_pipe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#efficiency_pipeline.lco_fakeSNpipeline.lco_pipe" title="Permalink to this definition">¶</a></dt>
<dd><p>pipeline that applies the epsf measurement, fake SN planting at different mags/locations, and detection efficiency measurement for groups of images.
the lco_path arg should be str to dir with the data
assumes data is in dirs like xx.xx date directory with field dirs that each has dirs dia_in/out/trim and source_im
figures/images will be made and stored in an output dir inside the source_ims</p>
</dd></dl>

<dl class="py function">
<dt id="efficiency_pipeline.lco_fakeSNpipeline.lco_pipe_ex">
<code class="sig-prename descclassname">efficiency_pipeline.lco_fakeSNpipeline.</code><code class="sig-name descname">lco_pipe_ex</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lco_path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">date_key</span><span class="o">=</span><span class="default_value">'08.17'</span></em>, <em class="sig-param"><span class="n">field_key</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/efficiency_pipeline/lco_fakeSNpipeline.html#lco_pipe_ex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#efficiency_pipeline.lco_fakeSNpipeline.lco_pipe_ex" title="Permalink to this definition">¶</a></dt>
<dd><p>Giving snapshot of important results for test case of image going through the pipeline.
Not actually running functions just loading results from previous run.</p>
</dd></dl>

<dl class="py function">
<dt id="efficiency_pipeline.lco_fakeSNpipeline.plant">
<code class="sig-prename descclassname">efficiency_pipeline.lco_fakeSNpipeline.</code><code class="sig-name descname">plant</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">psf</span></em>, <em class="sig-param"><span class="n">source_cat</span></em>, <em class="sig-param"><span class="n">hdr</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mag</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">location</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">zp</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plantname</span><span class="o">=</span><span class="default_value">'planted.fits'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/efficiency_pipeline/lco_fakeSNpipeline.html#plant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#efficiency_pipeline.lco_fakeSNpipeline.plant" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function for detection efficiency plants SNe (the scaled epsf) into an image to be detected
returns the planted image data and creates fits image using plantname arg
image argument should be difference fits, i.e. want to detect plants on difference
psf argument from epsf fcn
source_cat argument from source_cat fcn
zp argument left as None will be determined using hdr vals like zp=skybr+2.5*np.log10(L1med/exptime/pixscale)
mag argument scales epsf (the SN) like mu = 10**((mag-zp)/-2.5)*exptime*pixscale
location ~ where will plant is flexible:
Skycoord(ra,dec)
tuple for grid see lattice helper function
list for galaxy-galaxy strong lens target  see target helper function
None will use hdr val</p>
</dd></dl>

<dl class="py function">
<dt id="efficiency_pipeline.lco_fakeSNpipeline.source_cat">
<code class="sig-prename descclassname">efficiency_pipeline.lco_fakeSNpipeline.</code><code class="sig-name descname">source_cat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">nsigma</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">kernel_size</span><span class="o">=</span><span class="default_value">3, 3</span></em>, <em class="sig-param"><span class="n">npixels</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">deblend</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">contrast</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">targ_coord</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/efficiency_pipeline/lco_fakeSNpipeline.html#source_cat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#efficiency_pipeline.lco_fakeSNpipeline.source_cat" title="Permalink to this definition">¶</a></dt>
<dd><p>function that gives catalog of detected objects in fits image with photometry based measurements
arguments:
image ~ the fits file that will be searched
nsigma ~ what is considered ‘detectable’ in photutils detect_threshold, which does sigma clipped stats to get image bkg
kernel_size ~ pixel size of gaussian kernel convolved with data to smooth image objs
npixels ~ number of pixels which must be connected above nsigma threshold (connectivity=8 along edges or corner)
if very crowded…
deblend will check detected objs for local peaks with contrast (percentage of obj total flux) &gt; .001</p>
</dd></dl>

<dl class="py function">
<dt id="efficiency_pipeline.lco_fakeSNpipeline.stars">
<code class="sig-prename descclassname">efficiency_pipeline.lco_fakeSNpipeline.</code><code class="sig-name descname">stars</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">results</span></em>, <em class="sig-param"><span class="n">Nbrightest</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/efficiency_pipeline/lco_fakeSNpipeline.html#stars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#efficiency_pipeline.lco_fakeSNpipeline.stars" title="Permalink to this definition">¶</a></dt>
<dd><p>epsf helper function extracts good stars from image and turns them into photutil epsf star objects
good ~ well measured isolated stars:
bbox of 25 pixels is used for extraction, any overlapping stars are removed
gaia rp s/n &lt; 100 removed
any stars with flux value &gt; saturation or non-lin of image are removed
results argument is the gaia_results</p>
</dd></dl>

<dl class="py function">
<dt id="efficiency_pipeline.lco_fakeSNpipeline.target">
<code class="sig-prename descclassname">efficiency_pipeline.lco_fakeSNpipeline.</code><code class="sig-name descname">target</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">targ_obj</span></em>, <em class="sig-param"><span class="n">ref</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">diff</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/efficiency_pipeline/lco_fakeSNpipeline.html#target"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#efficiency_pipeline.lco_fakeSNpipeline.target" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function for the target detection efficiency
gives cutouts on images (trim,ref,diff) around galaxy-galaxy strong lens
checks source catalog to make sure it is one of image’s detected objects otherwise will get properties from reference</p>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="module-efficiency_pipeline.lco_figures">
<span id="lco-figures"></span><h3>lco_figures<a class="headerlink" href="#module-efficiency_pipeline.lco_figures" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="contributors.html" class="btn btn-neutral float-right" title="Primary Contributors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="examples/plot_package.html" class="btn btn-neutral float-left" title="Basic Functionality" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020 Kyle OConnor

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>